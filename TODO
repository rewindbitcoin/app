cuando en la wallet doy a goBack tarda años

OJO! A veces en carteras vaciuas me han salido los 3 botones. Eso es que utxosData
se cohge de otras carteras lo cual es increiblemente peligroso!!

En useStorage, si paso GLOBAL comprobar que el contexto está instalado.


-> En realidad solo los useState pueden estar desincronizados
    -> walletError (y eso tampoco), signersCiperKey, dataCipherKey, newSigners (puede ser ref), discovery (noooo), utxosData, syncingBlockchain
    -> discovery debe de ser state porque se tiene que esperar a que se conecte y además luego
    hay que desconectarlo

    -> Lo cual me hace pensar que si uso deriver data solamente, entonces el logOut no sea
    necesario?
      -> Básicamente lo que busco con el logOut es que el password y las derivedKeys se re-prompteen.
      Pero es lo unico


  // Local State: btcFiat, feeEstimates & discovery
  const [btcFiat, setBtcFiat] = useState<number | null>(null);
  const [feeEstimates, setFeeEstimates] = useState<Record<
    string,
    number
  > | null>(null);
  const [discovery, setDiscovery] = useState<DiscoveryInstance | null>(null); //TODO: useRef?
  const [utxosData, setUtxosData] = useState<UtxosData>();
  -> Deberían ser datos derivados?
  -> El setUtxosData, ... el syncBlockchain, ... cualquier set tiene que verificar
  a q walletId hacía referencia y no hacer el setUtxosData, setDiscoveryDataExport y cualquier
  set de un useSorage que se ha hecho de forma asíncrona
  -> Los useRef tambien hay q resetearlos en el logOut, useRef tambien tienen cleanUp functions
  -> Los sets no deberían de producirse dentro de los useCallback ?
    -> dentro de cada useCallback inicializar un walletId, luego ver donde tento
    awaits, luego, despues de cada await verificar si wallet.id === initialWalletId
    El problema que aun queda es que los setUtxosData que vienen de useStorage sonb asincronos
    TENGO QUE TENER UNA VARIABLE QUE SEA writing que no me permita hacer un cambio 
    de onWallet si wriring === true
    quizá useStorage pueda devolver "writing":  true/false

    MAS FACIL pasar a  useStorage key 'string' o getKey() => string
    la ventaja de getCurrentKey es que se comprueba siempre!!!
    La primera key se guardará dentro del useSorage y luego se irá llamando
    a getCurrentKey y se hará throw si casca
      -> Recordar que const getSignersKey = useCallback(()=>`SIGNERS_${walletId}`, [walletId])

    opcionalmente (, .... getCurrentKey)
    donde getCurrentKey devuelve la actual

    -> Añadir opcionalmente una key para que se verifique y throw si error en setStorageValue(value, key),
      deleteValue(key),
      clearCache(key),
      { isSynchd, errorCode, 
      //add:
      isSynchdFunc(key), errorCodeFunc(key)}

      O el logOut tiene qiue esperar a quje no se esté escribiendo nada?
        -> En cualquier caso el logOut debe de tener en cuenta lo de arriba

        O esto:
          const safeClearSignersCache = (() => {
    const creationWalletId = walletId;
    return () => {
      if (walletId !== creationWalletId)
        throw new Error(
          `Unsafe clearSignersCache: was crated with ${creationWalletId}, was tring to clear ${walletId}`
        );
      return clearSignersCache();
    };
  })();



The padding bottom for Wallets and WalletHome should be larger thatn the
position of the buttons on the bottom


el handleVault no debería aparecer dependiendo de utxos length, lo mismo para receive
puede ser q tenga algo de utxos pero no pueda fabricar una tx.


cssInterop no funciona bien en Web!!! los fontSize pasa de ellos - quitar toda referencia a cssInterop
  -> Ademas advancd options, el icono de swap entre real y test no esta bien alineado verticalmente

Test password + secure store
test idb + password
tst idb + derived seed (encrypt app data)

Test como se ve la App con dark mode activado !!!
  https://stackoverflow.com/questions/57175226/how-to-disable-night-mode-in-my-application-even-if-night-mode-is-enable-in-andr/64339016#64339016

The Password when is re-prompted should show a "Bad Password" or something
  -> Además debe de borrarme el texto antiguo? wuizas no

No me refrescha wallet 3 (goat oak)

I WalletContext I need to keep track of all the storage synchd status
and render a Loading... when not all of them are synched.
This will also let me get the derived cipher key from the signers so that i can
access the encrypted data

In App.tsx I can create versions of all components in Routes using useCallback

The getSeedDerivedCipherKey, i'm not sure its a great idea to have one different
cipher key per path, because when dealing with HWW this will force lots of
HWW clicks
  -> In fact it's just fine to have a unique vaultId but the cipherKey is
  the same for all the vaults for the same signer

The BTC rate is called too much. I beliueve everytime i set a wallet i create new queries
  -> In any way i should not rely on coingecko

Test-
  Wroing password
  User desenrolls FaceId (changes FaceId - does not work biometric anymore for different id)


Los collores de los textos "Test Wallet No Real _BValue" tienen backgroudna aleatorio??

BTC rates from thunderden (no coingecko)
dont use policy compiler

Cloudflare captcha:
https://dev.to/ryabinin/protect-your-react-native-application-using-cloudflare-turnstile-4l4l

Testnet testing wallet with funds: (deprecated/testingWallet.ts)
              'goat oak pull seek know resemble hurt pistol head first board better'



Immediate things to fix:

  Mas Padding a los USD , days
  
  Test web + android
  
  Si pongo directamente un valor mayor del posible en el Input de Vault Amount entonce TAMBUEN me sale el error de demasiadas Fees, lo cual es un lio!
    -> Lo he desactivado por el momento por ese motivo
  
  Esto lo tengo que tratar más arriba. Si los valores no son posible entonces mostrar por pantalla que no es posible directamente. antes de mostrar el cuadro de sliders.
          {maxVaultAmount !== undefined &&
            largestMinVaultAmount !== undefined &&
            maxVaultAmount >= largestMinVaultAmount && (
  
  En el mode rotator de USD , etc. mejor mostrar un Modal que me deje elegir entre todo lo que hay
  
  Simplificar y mucho los stles de SetUpVaultScreen cuando haya acabado
  
  
  Mover el ALL FIUNDS arriba y las unidades abajo
  Las bolitas del slider no son azules ahora
  Al hacer slide en el Slider (si tengo keyb abierto) poner el cursor a la derecha del todo
  Si me sale un error
  May never confirm en NARANJA - Si se elige mostrar warning Modal


-----
TODO: There is an issue. If the user selects locale es-ES but uses 
en-US in the system, then the keyboard for the numbers (the fee rate) will not
let use "," (commas) as decimal separator.
  SOLUTION: Do not let the user pick a locale and use the system one

TODO: Document the new APIs for storage
TODO: Add a default:       contentInsetAdjustmentBehavior="automatic"
      -> But on Android this wont work. Perhaps better use useHeaderHeight:
      https://reactnavigation.org/docs/7.x/native-stack-navigator/#headertransparent
TODO: I'll need a way to download from server / user storage backuped Vaults.
Note that these backuped vaults may be need to be merged (not replaced) with the
user current ones.
TODO: when the Wallets are presented so that you can pick one, if they are password
protected, then provide a Button "Forgot password"
TODO: when using SECURESTORAGE data can be removed any time! Thus, we need to provide
ways to recover from this.
  I need need to implement what to do if the user changes his biometrics.
  Note that in that case, then data stored securely cannot be accessed anymore.
  I will need a way to provide a way to detect that this data is missing (the SIGNERS for that wallet) and provide a way to
  allow re-entering a seed and reassociate it with the seed with the wallet id.
  This is for future releases?
  Read more in storage.ts

TODO: What happens if the user cannot recover from SecureStorage???
  -> Then he can still access the rest of data except 
TODO: When moving the slider then focus to the end of the textinput
TODO: In the slider set MAX when going to the MAX
TODO: in app.json i still need to set 
      "infoPlist": { "NSFaceIDUsageDescription": "TODO" },
      This is the string shown in the app when trying to use FaceId for the SecureStorage
      A good text needs to be there in mutiuple languages. but how


TODO: make it so that useSorage can pass initial object. Then its set as a useRef and after inital sync it stores the ref if did not exist yet? HOwever only set both isSycnd & new value state after it has been correctly stored in storage.
TODO: separate app-speciffic transalations from common and refactor code
TODO: separate app-speciffic styleds from common and refactor code
TODO: Replace all memoize calls (specially Factories) with moize
TODO: Wallets should have now the Create New Wallet functionality. Also the "Select Wallet".
TODO: Wallets is automatically generating Wallet 0 if no wallets exist. Remove this before shipping.
TODO: extremelly important, before sharing this module make sure
  this works properly: react-native-get-random-values
  See: https://www.reddit.com/r/Bitcoin/comments/37oxow/the_security_issue_of_blockchaininfos_android/
TODO: All Screens should use <ScrollView> with same options. Also default headers amke use of useAreaInsets fine, however, in those screens without defauklt header or bottom tabs that support insets, we must set them!
  -> https://reactnavigation.org/docs/handling-safe-area/
